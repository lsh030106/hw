# TDD 프로그래밍 방법론



#### 단위 테스트를 작성해야 하는 이유

+ 코드를 수정하거나 기능을 추가할 때 수시로 빠르게 검증 가능하다
+ 리팩토링 시에 안정성을 확보할 수 있다.
+ 개발 및 테스팅에 대한 시간과 비용을 절감할 수 있다. 



#### 좋은 테스트의 특징

> FIRST 규칙

+ Fast : 테스트는 빠르게 동작하여 자주 돌릴 수 있어야 한다.
+ Indenpendent : 각각의 테스트는 독립적이며 서로 의존해서는 안된다.
+ Repeatable: 어느 환경에서도 반복 가능해야 한다.
+ Self-Validating: 테스트는 성공 또는 실패로 bool 값으로 결과를 내어 자체적으로 검증되어야 한다.
+ Timely: **테스트는 적시에 즉, 테스트하려는 실제 코드를 구현하기 직전에 구현해야 한다.**

실패 테스트부터 작성, 순차적으로 실패하는 테스트를 먼저 작성하고, 오직 테스트가 실패할 경우에만 새로운 코드를 작성해야 한다.



#### TDD(Test-Driven Development, 테스트 주도 개발) 방법 및 순서

TDD 개발 방법론의 프로그래밍 순서는 아래와 같다

1. 실패하는 작은 단위 테스트를 작성한다. 처음에는 컴파일조차 되지 않을 수 있다.
2. 빨리 테스트를 통과하기 위해 프로덕션 코드를 작성한다. 가짜 구현 등을 작성할 수도 있다.
3. 그 다음의 테스트 코드를 작성한다. 실패 테스트가 없을 경우에만 성공 테스트를 작성한다.
4. 새로운 테스트를 통과하기 위해 프로덕션 코드를 추가 또는 수정한다.
5. 1 ~ 4 단계를 반복하여 실패/성공의 모든 테스트 케이스를 작성한다.
6. 개발된 코드들에 대해 모든 중복을 제거하며 리펙토링한다.



#### TDD 접근 방법

+ 가짜로 구현하기: 최대한 빨리 테스트를 통과하기 위해 정답이 아닌 가짜 정답을 구현하는 방법
+ 삼각 측량법: 값이 다른 어려 테스트를 작성하고, 이를 일반화하여 정답을 구현하는 방법
+ 명백하게 구현: 정답을 바로 구현하는 방법



#### 가짜로 구현하기

```c++
TEST(MultiplyTest, HandlesInput) {
    EXPECT_EQ(multiply(2, 3), 6);
}

// 위의 테스트를 가장 빠르게 통과하는 방법은 6을 반환하는 것

int multiply(int n1, int n2) {
	return 6;
}
```

위와 같이 변수를 사용하지 않고 상수를 반환하며, 답이 아닌 방법으로 가짜 구현하여 **최대한 빨리 테스트를 통과하는 것이** 가짜 구현 방법이다.

가짜 구현으로 연습을 해둔다면 복잡한 코드일 경우에 단계를 잘게 쪼개서 TDD로 문제없이 개발하는 능력을 갖출 수 있다. 가짜 구현으로 개발하면 다음과 같은 2가지 효과를 얻을 수 있다.

+ 심리학적: 빨간 막대와 초록 막대 상태는 완전히 다르다. 막대가 초록색이라면 어느 위치인지 알고 거기부터 리팩토링해 갈 수 있다.
+ 범위 조절: 하나의 구체적인 예에서 일반화를 함으로써, 불필요한 고민으로 혼동되는 일을 예방할 수 있다.



#### 삼각 측량

```cpp
TEST(MultiplyTest, HandlesInput) {
    EXPECT_EQ(multiply(2, 3), 6);
    EXPECT_EQ(multiply(4, 7), 28);
}
```

삼각 측량은 테스트 주도로 추상화된 과정을 일반화하는 과정이다. 삼각 측량 방법은 테스트 예시가 2개 이상일 때만 추상화를 해야 한다.



#### 명백하게 구현하기 

```c++
int multiply(int n1, int n2) {
	return n1 * n2;
}
```

명백하게 구현하는 방법은 가짜 구현이나 삼각 측량 방법을 사용하지 않고 바로 정답을 구현하는 방법이다.

위와 같이 곱하기 같은 문제는 쉬우니 위와 같이 바로 명백하게 구현을 해줘도 괜찮다.

